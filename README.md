# Проект ap-server


## Требования к Backend

* [Docker](https://www.docker.com/).
* [Docker Compose](https://docs.docker.com/compose/install/).
* [Poetry](https://python-poetry.org/) - управление пакетами и средой Python.

## Требования к Frontend

* Node.js (with `npm`).

## Backend локальная разработка

* Запуск проекта с помощью Docker Compose:

```bash
docker-compose up -d
```

* Теперь Вы можете открыть свой браузер и взаимодействовать с этими URL-адресами:

Frontend, созданный с помощью Docker, с обработкой маршрутов на основе routes: http://localhost

Backend, API на основе OpenAPI возращающий JSON: http://localhost/api/

Автоматическая интерактивная документация с пользовательским интерфейсом Swagger (из бэкэнда OpenAPI): http://localhost/docs

Альтернативная автоматическая документация ReDoc (из бэкэнда OpenAPI): http://localhost/redoc

PGAdmin, web-интерфейс для администрирования PostgreSQL: http://localhost:5050

Flower,  web-интерфейс для администрирования задач Celery: http://localhost:5555

Пользовательский интерфейс Traefik, для мониторинга обработки маршрутов proxy: http://localhost:8090

** Примечание **: первый запуск проекта может занять продолжительное время. Пока серверная часть собирается из исходных кодов вы можете проверить журналы, чтобы следить за сборкой.

Чтобы проверить журналы, запустите:

```bash
docker-compose logs
```

Чтобы проверить журналы конкретной службы, добавьте имя службы, например:

```bash
docker-compose logs backend
```

Если ваш Docker не запущен на локальной машине (указанные выше URL-адреса не работают), проверьте разделы ниже **Разработка с помощью Docker Toolbox** и **Разработка с публичным IP**.

## Локальная разработка серверной части, дополнительные сведения

### Общий рабочий процесс

По умолчанию зависимости управляются с помощью [Poetry] (https://python-poetry.org/), перейдите туда и установите его.

Из `./Backend/app/` вы можете установить все зависимости с помощью команды:

```console
$ poetry install
```

Затем вы можете запустить сеанс shell в среде разработки с помощью команды:

```console
$ poetry shell
```

Затем откройте `./Backend/app/` в среде разработки (вместо корня проекта: `./`), Вы увидете каталог `./App/` с кодом внутри. Таким образом, среда разработки сможет найти все импортированные файлы и т. Д. Убедитесь, что среда разработки использует shell, которую вы только что создали с помощью Poetry.

Модели SQLAlchemy находятся в директории `./Backend/app/app/models/`, схемы Pydantic нахоядтся в директории `./Backend/app/app/schemas/`, методы API находяться в директории `./Backend/app/app/api/`, CRUD (создание, чтение, обновление, удаление) утилит находятся в директории `./ Backend/app/app/crud/`.

Здачи для Celery worker находятся в директории `./Backend/app/app/worker.py`.

Для установки дополнительного пакета celeryworker, пакет необходимо добавить в файл `./backend/app/celeryworker.dockerfile`.

### Docker Compose Override

Во время разработки вы можете изменить настройки Docker Compose, которые будут влиять только на локальную среду разработки, в файле `docker-compose.override.yml`.
